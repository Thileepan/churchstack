MAIN DATABASE:
==============
create database CHURCHSTACK collate latin1_general_cs;

create table CHURCH_DETAILS (
	CHURCH_ID BIGINT NOT NULL unique AUTO_INCREMENT,
	CHURCH_NAME VARCHAR(255) NOT NULL,
	DESCRIPTION VARCHAR(1024) NOT NULL,
	ADDRESS VARCHAR(1024) NOT NULL,
	LANDLINE VARCHAR(20) NOT NULL,
	MOBILE VARCHAR(20) NOT NULL,
	EMAIL VARCHAR(255) NOT NULL,
	WEBSITE VARCHAR(255) NOT NULL,
	SIGNUP_TIME TIMESTAMP NOT NULL,
	LAST_UPDATE_TIME TIMESTAMP NOT NULL,
	SHARDED_DATABASE VARCHAR(255) NOT NULL,

	constraint CHURCH_DETAILS_PK PRIMARY KEY (CHURCH_ID)
);

create table USER_DETAILS (
	USER_ID BIGINT NOT NULL unique AUTO_INCREMENT,
	CHURCH_ID BIGINT NOT NULL,
	USER_NAME VARCHAR(255) NOT NULL,
	ROLE_ID INTEGER NOT NULL,
	PASSWORD VARCHAR(255) NOT NULL,
	STATUS TINYINT NOT NULL,

	constraint USER_DETAILS_PK PRIMARY KEY (USER_ID),
	constraint USER_DETAILS_FK FOREIGN KEY (CHURCH_ID) REFERENCES CHURCH_DETAILS (CHURCH_ID)
);

SHARDED DATABASE:
=================
create database CS01_CHURCHSTACK collate latin1_general_cs;
use CS01_CHURCHSTACK;


create table PROFILE_DETAILS (
	PROFILE_ID INTEGER UNSIGNED NOT NULL AUTO_INCREMENT,
	SALUTATION_ID VARCHAR(255),
	NAME VARCHAR(128),
	UNIQUE_ID INTEGER UNSIGNED,
	DOB DATE,
	GENDER TINYINT NOT NULL,
	RELATION_SHIP SMALLINT,
	MARITAL_STATUS TINYINT,
	MARRIAGE_DATE DATE,
	MARRIAGE_PLACE VARCHAR(128),
	ADDRESS1 VARCHAR(128),
	ADDRESS2 VARCHAR(128),
	ADDRESS3 VARCHAR(128),
	AREA VARCHAR(64),
	PINCODE VARCHAR(10),
	LANDLINE VARCHAR(20),
	MOBILE1 VARCHAR(20),
	MOBILE2 VARCHAR(20),
	EMAIL VARCHAR(64),
	PROFILE_STATUS TINYINT,
	NOTES VARCHAR(1024),
	BABTISED TINYINT,
	CONFIRMATION TINYINT,
	OCCUPATION VARCHAR(256),
	IS_ANOTHER_CHURCH_MEMBER TINYINT,
	PARENT_PROFILE_ID INTEGER,
	MIDDLE_NAME VARCHAR(128),
	LAST_NAME VARCHAR(128),
	WORK_PHONE VARCHAR(20),
	FAMILY_PHOTO_LOCATION VARCHAR(256),
	PROFILE_PHOTO_LOCATION VARCHAR(256),
	EMAIL_SUBSCRIPTION TINYINT DEFAULT 1,
	SMS_SUBSCRIPTION TINYINT DEFAULT 1,

	index PROFILE_DETAILS_IDX_1 (NAME),
	index PROFILE_DETAILS_IDX_2 (UNIQUE_ID),
	index PROFILE_DETAILS_IDX_3 (DOB),
	index PROFILE_DETAILS_IDX_4 (GENDER),
	index PROFILE_DETAILS_IDX_5 (MARITAL_STATUS),
	index PROFILE_DETAILS_IDX_6 (MARRIAGE_DATE),
	index PROFILE_DETAILS_IDX_7 (EMAIL),
	index PROFILE_DETAILS_IDX_8 (PROFILE_STATUS),
	index PROFILE_DETAILS_IDX_9 (BABTISED),
	index PROFILE_DETAILS_IDX_10 (CONFIRMATION),
	index PROFILE_DETAILS_IDX_11 (PARENT_PROFILE_ID),
	index PROFILE_DETAILS_IDX_12 (MIDDLE_NAME),
	index PROFILE_DETAILS_IDX_13 (LAST_NAME),
	index PROFILE_DETAILS_IDX_14 (EMAIL_SUBSCRIPTION),
	index PROFILE_DETAILS_IDX_15 (SMS_SUBSCRIPTION),
	constraint PROFILE_DETAILS_PK PRIMARY KEY (PROFILE_ID, UNIQUE_ID)
);

create table FUND_DETAILS (
	FUND_ID INTEGER UNSIGNED NOT NULL AUTO_INCREMENT,
	FUND_NAME VARCHAR(64),
	FUND_DESCRIPTION VARCHAR(512),

	constraint FUND_DETAILS_PK PRIMARY KEY (FUND_ID)
);

create table BATCH_DETAILS (
	BATCH_ID INTEGER UNSIGNED NOT NULL AUTO_INCREMENT,
	BATCH_NAME VARCHAR(64),
	BATCH_DESCRIPTION VARCHAR(512),

	constraint BATCH_DETAILS_PK PRIMARY KEY (BATCH_ID)
);

create table CONTRIBUTION_DETAILS (
	CONTRIBUTION_ID BIGINT UNSIGNED NOT NULL AUTO_INCREMENT,
	CONTRIBUTION_DATE DATETIME,
	BATCH_ID INTEGER UNSIGNED,	
	PROFILE_ID INTEGER UNSIGNED, 
	TRANSACTION_TYPE TINYINT,
	PAYMENT_MODE SMALLINT,
	REFERENCE_NUMBER VARCHAR(255),
	LAST_UPDATE_TIME DATETIME,
	LAST_UPDATE_USER_ID BIGINT UNSIGNED,
	LAST_UPDATE_USER_NAME VARCHAR(128),

	constraint CONTRIBUTION_DETAILS PRIMARY KEY (CONTRIBUTION_ID)
);

create table CONTRIBUTION_SPLIT_DETAILS (
	CONTRIBUTION_SPLIT_ID BIGINT UNSIGNED NOT NULL AUTO_INCREMENT,
	CONTRIBUTION_ID BIGINT UNSIGNED,
	FUND_ID INTEGER UNSIGNED,	
	AMOUNT DECIMAL(15,2),
	NOTES VARCHAR(255),

	constraint CONTRIBUTION_SPLIT_DETAILS_FK_1 FOREIGN KEY (CONTRIBUTION_ID) REFERENCES CONTRIBUTION_DETAILS (CONTRIBUTION_ID)
);

create table SUBSCRIPTION_FIELDS (
	FIELD_ID TINYINT NOT NULL unique AUTO_INCREMENT,
	FIELD_NAME VARCHAR(255) NOT NULL,
	HIDE TINYINT NOT NULL
);

create table SUBSCRIPTION_DETAILS (
	SUBSCRIPTION_ID BIGINT NOT NULL unique AUTO_INCREMENT,
	PROFILE_ID BIGINT NOT NULL,
	DATE_OF_SUBSCRIPTION DATE NOT NULL,
	SUB_FIELD_1 FLOAT NOT NULL,
	SUB_FIELD_2 FLOAT NOT NULL,
	SUB_FIELD_3 FLOAT NOT NULL,
	SUB_FIELD_4 FLOAT NOT NULL,
	SUB_FIELD_5 FLOAT NOT NULL,
	SUB_FIELD_6 FLOAT NOT NULL,
	SUB_FIELD_7 FLOAT NOT NULL,
	SUB_FIELD_8 FLOAT NOT NULL,
	SUB_FIELD_9 FLOAT NOT NULL,
	SUB_FIELD_10 FLOAT NOT NULL,
	SUB_FIELD_11 FLOAT NOT NULL,
	SUB_FIELD_12 FLOAT NOT NULL,
	SUB_FIELD_13 FLOAT NOT NULL,
	SUB_FIELD_14 FLOAT NOT NULL,
	SUB_FIELD_15 FLOAT NOT NULL,
	SUB_FIELD_16 FLOAT NOT NULL,
	SUB_FIELD_17 FLOAT NOT NULL,
	SUB_FIELD_18 FLOAT NOT NULL,
	SUB_FIELD_19 FLOAT NOT NULL,
	SUB_FIELD_20 FLOAT NOT NULL,
	TOTAL_AMOUNT FLOAT NOT NULL,
	
	constraint SUBSCRIPTION_DETAILS_PK PRIMARY KEY (SUBSCRIPTION_ID)
);

create table HARVEST_DETAILS (
	HARVEST_ID BIGINT NOT NULL unique AUTO_INCREMENT,
	PROFILE_ID BIGINT NOT NULL,
	DATE_OF_HARVEST DATE NOT NULL,
	ITEM_DESCRIPTION VARCHAR(255) NOT NULL,
	ITEM_AMOUNT FLOAT NOT NULL,
		
	constraint HARVEST_DETAILS_PK PRIMARY KEY (HARVEST_ID)
);

create table PROFILE_SETTINGS (
	SETTINGS_ID INTEGER NOT NULL,
	OPTION_ID INTEGER NOT NULL,
	OPTION_VALUE VARCHAR(255) NOT NULL,

	constraint PROFILE_SETTINGS_PK PRIMARY KEY (SETTINGS_ID, OPTION_ID)
);

create table REPORTS (
	REPORT_ID BIGINT NOT NULL unique AUTO_INCREMENT,
	TITLE VARCHAR(255) NOT NULL,
	DESCRIPTION VARCHAR(1024) NOT NULL,

	constraint REPORTS_PK PRIMARY KEY (REPORT_ID)
);

create table REPORT_RULES (
	REPORT_ID BIGINT NOT NULL,
	RULE_TYPE VARCHAR(50) NOT NULL,
	RULE_SUB_TYPE VARCHAR(50) NOT NULL,
	RULE_VALUE VARCHAR(50) NOT NULL,
	constraint REPORT_RULES_FK FOREIGN KEY (REPORT_ID) REFERENCES REPORTS(REPORT_ID)
);

create table REPORT_COLUMNS (
	REPORT_ID BIGINT NOT NULL,
	COLUMN_CATEGORY VARCHAR(50) NOT NULL,
	COLUMN_DATA VARCHAR(50) NOT NULL,
	COLUMN_HEADING VARCHAR(50) NOT NULL,

	constraint REPORT_COLUMNS_FK FOREIGN KEY (REPORT_ID) REFERENCES REPORTS(REPORT_ID)
);

create table EVENT_DETAILS (
	EVENT_ID BIGINT NOT NULL unique AUTO_INCREMENT,
	TITLE VARCHAR(255) NOT NULL,
	DESCRIPTION VARCHAR(1024) NOT NULL,
	EVENT_LOCATION VARCHAR(255) NOT NULL,
	START_DATE DATE NOT NULL,
	END_DATE DATE NOT NULL,
	START_TIME SMALLINT NOT NULL,
	END_TIME SMALLINT NOT NULL,
	RRULE VARCHAR(255) NOT NULL,
	PRIORITY SMALLINT NOT NULL,
	ORGANISER VARCHAR(255) NOT NULL,
	ACCESS_LEVEL SMALLINT NOT NULL,

	constraint EVENT_DETAILS_PK PRIMARY KEY (EVENT_ID)
);

create table EVENT_PARTICIPANTS (
	EVENT_ID BIGINT NOT NULL,
	PARTICIPANT_TYPE SMALLINT NOT NULL,
	PARTICIPANT_ID BIGINT NOT NULL,
	PARTICIPANT_EMAIL VARCHAR(100) NOT NULL,

	constraint EVENT_PARTICIPANTS_FK FOREIGN KEY (EVENT_ID) REFERENCES EVENT_DETAILS(EVENT_ID)
);

create table EVENT_NOTIFICATIONS (
	EVENT_ID BIGINT NOT NULL,
	NOTIFICATION_TYPE SMALLINT NOT NULL,
	NOTIFICATION_PERIOD SMALLINT NOT NULL,	

	constraint EVENT_NOTIFICATIONS_FK FOREIGN KEY (EVENT_ID) REFERENCES EVENT_DETAILS(EVENT_ID)
);

create table GROUP_DETAILS (
	GROUP_ID BIGINT NOT NULL unique AUTO_INCREMENT,
	GROUP_NAME VARCHAR(100) NOT NULL,
	DESCRIPTION VARCHAR(1024) NOT NULL,

	constraint GROUP_DETAILS_PK PRIMARY KEY (GROUP_ID)
);

create table GROUP_MEMBERS (
	GROUP_ID BIGINT NOT NULL,
	PROFILE_ID BIGINT NOT NULL,

	constraint GROUP_MEMBERS_PK PRIMARY KEY (GROUP_ID, PROFILE_ID),
	constraint GROUP_MEMBERS_FK FOREIGN KEY (GROUP_ID) REFERENCES GROUP_DETAILS(GROUP_ID)
);

create table CHURCH_MEMBERS (
	PROFILE_ID INT NOT NULL,
	ROLE VARCHAR(50) NOT NULL,	
);

create table PROFILE_CUSTOM_FIELDS (
	FIELD_ID INTEGER UNSIGNED NOT NULL unique AUTO_INCREMENT,
	FIELD_NAME VARCHAR(50),
	FIELD_TYPE SMALLINT,
	FIELD_OPTIONS TEXT,
	FIELD_HELP_MESSAGE VARCHAR(1024),
	IS_REQUIRED TINYINT,	
	VALIDATION VARCHAR(250),
	DISPLAY_ORDER INTEGER
);

create table PROFILE_CUSTOM_FIELD_VALUES (
	PROFILE_ID INTEGER UNSIGNED,
	FIELD_ID INTEGER UNSIGNED,
	FIELD_VALUE TEXT
);

DEFAULT VALUES:
===============
insert into PROFILE_SETTINGS values (1, 1, 'Mr');
insert into PROFILE_SETTINGS values (1, 2, 'Mrs');
insert into PROFILE_SETTINGS values (1, 3, 'Baby');
insert into PROFILE_SETTINGS values (1, 4, 'Dr');
insert into PROFILE_SETTINGS values (1, 5, 'Ms');
insert into PROFILE_SETTINGS values (1, 6, 'Rev');
insert into PROFILE_SETTINGS values (1, 7, 'Master');

insert into PROFILE_SETTINGS values (2, 1, 'Self');
insert into PROFILE_SETTINGS values (2, 2, 'Wife');
insert into PROFILE_SETTINGS values (2, 3, 'Son');
insert into PROFILE_SETTINGS values (2, 4, 'Daughter');
insert into PROFILE_SETTINGS values (2, 5, 'Brother');
insert into PROFILE_SETTINGS values (2, 6, 'Sister');
insert into PROFILE_SETTINGS values (2, 7, 'Husband');
insert into PROFILE_SETTINGS values (2, 8, 'Grand Son');
insert into PROFILE_SETTINGS values (2, 9, 'Grand Daughter');
insert into PROFILE_SETTINGS values (2, 10, 'Mother');
insert into PROFILE_SETTINGS values (2, 11, 'Father');
insert into PROFILE_SETTINGS values (2, 12, 'Mother in Law');
insert into PROFILE_SETTINGS values (2, 13, 'Father in Law');
insert into PROFILE_SETTINGS values (2, 14, 'Daughter in Law');
insert into PROFILE_SETTINGS values (2, 15, 'Son in Law');

insert into PROFILE_SETTINGS values (3, 1, 'Single');
insert into PROFILE_SETTINGS values (3, 2, 'Married');
insert into PROFILE_SETTINGS values (3, 3, 'Widow');

insert into PROFILE_SETTINGS values (4, 1, 'Active');
insert into PROFILE_SETTINGS values (4, 2, 'InActive');
insert into PROFILE_SETTINGS values (4, 3, 'Expired');

insert into CHURCH_DETAILS (church_id, CHURCH_NAME, DESCRIPTION, ADDRESS, LANDLINE, MOBILE, EMAIL, WEBSITE, SIGNUP_TIME, LAST_UPDATE_TIME, SHARDED_DATABASE) values (1, 'STC', '', '', '', '', '', '',20140417053827,20140417053827, 'cs01_database');
insert into USER_DETAILS (user_name, church_id, role_id, password, status) values ('admin', 1, 1, '21232f297a57a5a743894a0e4a801fc3', 1);

insert into SUBSCRIPTION_FIELDS (field_name, hide) values ('Subcription', 0);
insert into SUBSCRIPTION_FIELDS (field_name, hide) values ('Tieth', 0);
insert into SUBSCRIPTION_FIELDS (field_name, hide) values ('Bilding Fund', 0);
insert into SUBSCRIPTION_FIELDS (field_name, hide) values ('Harvest Festivals', 0);
insert into SUBSCRIPTION_FIELDS (field_name, hide) values ('Gospel', 0);
insert into SUBSCRIPTION_FIELDS (field_name, hide) values ('Charity', 0);
insert into SUBSCRIPTION_FIELDS (field_name, hide) values ('Widow', 0);
insert into SUBSCRIPTION_FIELDS (field_name, hide) values ('Cemetry', 0);
insert into SUBSCRIPTION_FIELDS (field_name, hide) values ('Youth', 0);
insert into SUBSCRIPTION_FIELDS (field_name, hide) values ('Women', 0);
insert into SUBSCRIPTION_FIELDS (field_name, hide) values ('Men', 0);
insert into SUBSCRIPTION_FIELDS (field_name, hide) values ('Festival', 0);
insert into SUBSCRIPTION_FIELDS (field_name, hide) values ('Church', 0);
insert into SUBSCRIPTION_FIELDS (field_name, hide) values ('Thanks', 0);

SET GLOBAL log_output = 'FILE';
SET GLOBAL general_log_file = 'E:/logfile.log';
SET GLOBAL general_log = 'ON';